{"version":3,"file":"dropdown.min.js","sources":["dropdown/dropdown.js"],"names":["angular","module","provider","defaults","this","animation","prefixClass","placement","template","trigger","container","keyboard","html","delay","$get","$window","$rootScope","$tooltip","DropdownFactory","element","config","onBodyClick","evt","target","$dropdown","hide","options","extend","$scope","scope","$new","$onKeyDown","test","keyCode","preventDefault","stopPropagation","items","$element","querySelectorAll","length","index","forEach","el","i","matchesSelector","call","isUndefined","eq","focus","show","setTimeout","on","bodyEl","parent","toggleClass","off","document","body","Element","prototype","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","directive","$location","$sce","restrict","link","attr","key","isDefined","bsDropdown","$watch","newValue","content","dropdown","$on","destroy"],"mappings":"AAOA,YACAA,SAAQC,OAAO,2BAA4B,2BAA2BC,SAAS,YAAa,WAC1F,GAAIC,GAAWC,KAAKD,UAChBE,UAAW,UACXC,YAAa,WACbC,UAAW,cACXC,SAAU,6BACVC,QAAS,QACTC,WAAW,EACXC,UAAU,EACVC,MAAM,EACNC,MAAO,EAEXT,MAAKU,MACH,UACA,aACA,WACA,SAAUC,EAASC,EAAYC,GAG7B,QAASC,GAAgBC,EAASC,GAgDhC,QAASC,GAAYC,GACnB,MAAIA,GAAIC,SAAWJ,EAAQ,GAEpBG,EAAIC,SAAWJ,EAAQ,IAAMK,EAAUC,OAF9C,OAhDF,CAAA,GAAID,MAEAE,EAAU1B,QAAQ2B,UAAWxB,EAAUiB,EAC/BI,GAAUI,OAASF,EAAQG,OAASH,EAAQG,MAAMC,QAAUd,EAAWc,OACnFN,EAAYP,EAASE,EAASO,GAE9BF,EAAUO,WAAa,SAAUT,GAC/B,GAAK,UAAUU,KAAKV,EAAIW,SAAxB,CAEAX,EAAIY,iBACJZ,EAAIa,iBAEJ,IAAIC,GAAQpC,QAAQmB,QAAQK,EAAUa,SAAS,GAAGC,iBAAiB,sBACnE,IAAKF,EAAMG,OAAX,CAEA,GAAIC,EACJxC,SAAQyC,QAAQL,EAAO,SAAUM,EAAIC,GAC/BC,GAAmBA,EAAgBC,KAAKH,EAAI,YAC9CF,EAAQG,KAGQ,KAAhBrB,EAAIW,SAAkBO,EAAQ,EAChCA,IACuB,KAAhBlB,EAAIW,SAAkBO,EAAQJ,EAAMG,OAAS,EACpDC,IACOxC,QAAQ8C,YAAYN,KAC3BA,EAAQ,GACVJ,EAAMW,GAAGP,GAAO,GAAGQ,UAGrB,IAAIC,GAAOzB,EAAUyB,IACrBzB,GAAUyB,KAAO,WACfA,IACAC,WAAW,WACTxB,EAAQf,UAAYa,EAAUa,SAASc,GAAG,UAAW3B,EAAUO,YAC/DqB,EAAOD,GAAG,QAAS9B,KAErBG,EAAUa,SAASgB,SAASC,YAAY,QAE1C,IAAI7B,GAAOD,EAAUC,IAarB,OAZAD,GAAUC,KAAO,WACfC,EAAQf,UAAYa,EAAUa,SAASkB,IAAI,UAAW/B,EAAUO,YAChEqB,EAAOG,IAAI,QAASlC,GACpBG,EAAUa,SAASgB,SAASC,YAAY,QACxC7B,KAQKD,EAvDT,GAAI4B,GAASpD,QAAQmB,QAAQJ,EAAQyC,SAASC,MAC1Cb,EAAkBc,QAAQC,UAAUf,iBAAmBc,QAAQC,UAAUC,uBAAyBF,QAAQC,UAAUE,oBAAsBH,QAAQC,UAAUG,mBAAqBJ,QAAQC,UAAUI,gBAwDvM,OAAO7C,OAGV8C,UAAU,cACX,UACA,YACA,OACA,YACA,SAAUjD,EAASkD,EAAWC,EAAM1C,GAClC,OACE2C,SAAU,MACVtC,OAAO,EACPuC,KAAM,SAAkBvC,EAAOV,EAASkD,GAEtC,GAAI3C,IAAYG,MAAOA,EACvB7B,SAAQyC,SACN,YACA,YACA,QACA,UACA,WACA,OACA,YACA,YACC,SAAU6B,GACPtE,QAAQuE,UAAUF,EAAKC,MACzB5C,EAAQ4C,GAAOD,EAAKC,MAGxBD,EAAKG,YAAc3C,EAAM4C,OAAOJ,EAAKG,WAAY,SAAUE,GACzD7C,EAAM8C,QAAUD,IACf,EAEH,IAAIE,GAAWpD,EAAUL,EAASO,EAElCG,GAAMgD,IAAI,WAAY,WACpBD,EAASE,UACTpD,EAAU,KACVkD,EAAW","sourcesContent":["'use strict';\n\nangular.module('mgcrea.ngStrap.dropdown', ['mgcrea.ngStrap.tooltip'])\n\n  .provider('$dropdown', function() {\n\n    var defaults = this.defaults = {\n      animation: 'am-fade',\n      prefixClass: 'dropdown',\n      placement: 'bottom-left',\n      template: 'dropdown/dropdown.tpl.html',\n      trigger: 'click',\n      container: false,\n      keyboard: true,\n      html: false,\n      delay: 0\n    };\n\n    this.$get = function($window, $rootScope, $tooltip) {\n\n      var bodyEl = angular.element($window.document.body);\n      var matchesSelector = Element.prototype.matchesSelector || Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector;\n\n      function DropdownFactory(element, config) {\n\n        var $dropdown = {};\n\n        // Common vars\n        var options = angular.extend({}, defaults, config);\n        var scope = $dropdown.$scope = options.scope && options.scope.$new() || $rootScope.$new();\n\n        $dropdown = $tooltip(element, options);\n\n        // Protected methods\n\n        $dropdown.$onKeyDown = function(evt) {\n          if (!/(38|40)/.test(evt.keyCode)) return;\n          evt.preventDefault();\n          evt.stopPropagation();\n\n          // Retrieve focused index\n          var items = angular.element($dropdown.$element[0].querySelectorAll('li:not(.divider) a'));\n          if(!items.length) return;\n          var index;\n          angular.forEach(items, function(el, i) {\n            if(matchesSelector && matchesSelector.call(el, ':focus')) index = i;\n          });\n\n          // Navigate with keyboard\n          if(evt.keyCode === 38 && index > 0) index--;\n          else if(evt.keyCode === 40 && index < items.length - 1) index++;\n          else if(angular.isUndefined(index)) index = 0;\n          items.eq(index)[0].focus();\n\n        };\n\n        // Overrides\n\n        var show = $dropdown.show;\n        $dropdown.show = function() {\n          show();\n          setTimeout(function() {\n            options.keyboard && $dropdown.$element.on('keydown', $dropdown.$onKeyDown);\n            bodyEl.on('click', onBodyClick);\n          });\n          $dropdown.$element.parent().toggleClass('open');\n        };\n\n        var hide = $dropdown.hide;\n        $dropdown.hide = function() {\n          options.keyboard && $dropdown.$element.off('keydown', $dropdown.$onKeyDown);\n          bodyEl.off('click', onBodyClick);\n          $dropdown.$element.parent().toggleClass('open');\n          hide();\n        };\n\n        // Private functions\n\n        function onBodyClick(evt) {\n          if(evt.target === element[0]) return;\n          return evt.target !== element[0] && $dropdown.hide();\n        }\n\n        return $dropdown;\n\n      }\n\n      return DropdownFactory;\n\n    };\n\n  })\n\n  .directive('bsDropdown', function($window, $location, $sce, $dropdown) {\n\n    return {\n      restrict: 'EAC',\n      scope: true,\n      link: function postLink(scope, element, attr, transclusion) {\n\n        // Directive options\n        var options = {scope: scope};\n        angular.forEach(['placement', 'container', 'delay', 'trigger', 'keyboard', 'html', 'animation', 'template'], function(key) {\n          if(angular.isDefined(attr[key])) options[key] = attr[key];\n        });\n\n        // Support scope as an object\n        attr.bsDropdown && scope.$watch(attr.bsDropdown, function(newValue, oldValue) {\n          scope.content = newValue;\n        }, true);\n\n        // Initialize dropdown\n        var dropdown = $dropdown(element, options);\n\n        // Garbage collection\n        scope.$on('$destroy', function() {\n          dropdown.destroy();\n          options = null;\n          dropdown = null;\n        });\n\n      }\n    };\n\n  });\n"],"sourceRoot":"/source/"}